(function(){var a,b=window.T;a={name:"OpenJS",version:"2.0",debug:!1,noConflict:function(){return window.T=b,a},copy:function(a,b,c,d){for(var e in b)if(c||typeof a[e]=="undefined")a[e]=d?d(b[e]):b[e];return a},create:function(a,b){var c=this,d=a?a.split("."):[],e=d.length;for(var f=0;f<e;f++){var g=d[f],h=c[g];h||(h=b&&f+1===e?b:{},c[g]=h),c=h}return c},extend:function(b,c,d){return a.copy(typeof b=="string"?a.create.call(this,b):b,c,d)},uid:function(a){var b;a=a||6,b=Math.random().toString(16).substr(2);if(b.length>a)b=b.substr(0,a);else if(b.length<a)for(var c=0,d=a-b.length;c<d;c++)b+=Math.random().toString(16).substr(2,1);return b}},function c(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=!-[1],q="boolean",r="number",s="string",t=/openjs\.js(.*)$/,u=/openjs\.proxy\.js(.*)$/,v,w={},x={debug:{type:q,"default":!1},loglevel:{type:r,"default":0},cookiedomain:{type:s,"default":""},cookiepath:{type:s,"default":"/"},crossdomainmethod:{type:s,"default":"auto"},autoboot:{type:q,"default":!0}},y,z,A,B=document.getElementsByTagName("script");y=function(a){a=A(a).toLowerCase();switch(a){case"no":case"off":case"false":return!1}return!!a},z=function(a,b){return parseInt(A(a),b)||0},A=String.prototype.trim?function(a){return a==null?"":String.prototype.trim.call(a)}:function(a){return a==null?"":a.toString().replace(/^\s+/,"").replace(/\s+$/,"")};for(b=0,c=B.length;b<c&&(d=B[b]);b++){e=p?d.getAttribute("src",4):d.src;if(e){v=e.match(t)||e.match(u);if(v){f=v[1],g=f.split("#").pop(),h=f.indexOf("?")==0?f.slice(1,f.indexOf("#")==-1?i:f.indexOf("#")):"";break}}}if(g){g=g.split("&");for(b=0,c=g.length;b<c&&(l=g[b]);b++){l=l.split("="),m=l[0].toLowerCase(),n=l.length>1?l[1]:i;if(x.hasOwnProperty(m)){o=x[m];switch(o.type){case q:n=y(n);break;case r:n=z(n,10);break;case s:default:n=A(n)}w[m]=n}}}for(var j in x)x.hasOwnProperty(j)&&!w.hasOwnProperty(j)&&(w[j]=x[j]["default"]);a.extend("envs",w)}(),a.debug=a.envs.debug,a.provide=a.create,window.QQWB=window.T=a})(),QQWB.extend("",{bind:function(a,b){a=a.toLowerCase();var c=QQWB,d=c.bigtable,e=d.get("eventhandler",a);return e?QQWB.Array.inArray(e,b)||e.push(b):d.put("eventhandler",a,[b]),c},once:function(a,b){a=a.toLowerCase();var c=QQWB,d;return d=function(){var e=b.apply(QQWB,arguments);return c.unbind(a,d),d=null,e},c.bind(a,d),c},unbind:function(a,b){a=a.toLowerCase();var c=QQWB,d=c.bigtable,e=d.get("eventhandler",a),f;if(e)if(b)for(f=0,l=e.length;f<l;f++)b===e[f]&&(b=null,e.splice(f,1));else d.del("eventhandler",a);return!d.get("eventhandler",a)},trigger:function(a,b){a=a.toLowerCase();var c=QQWB,d=c.Array,e=c.bigtable,f=e.get("eventhandler",a);b=d.fromArguments(arguments).slice(1);if(f)return d.forEach(f,function(a,d){if(a)return a.apply(c,b);return});return}}),QQWB.extend("Function",{isFunction:function(a){return typeof a=="function"}}),QQWB.extend("String",{_trimLeft:/^\s+/,_trimRight:/\s+$/,isString:function(a){return typeof a=="string"},ltrim:function(a){return a==null?"":a.toString().replace(this._trimLeft,"")},rtrim:function(a){return a==null?"":a.toString().replace(this._trimRight,"")},trim:String.prototype.trim?function(a){return a==null?"":String.prototype.trim.call(a)}:function(a){return a==null?"":a.toString().replace(this._trimLeft,"").replace(this._trimRight,"")},startsWith:String.prototype.startsWith?function(a,b){return a==null?!1:String.prototype.startsWith.call(a,b)}:function(a,b){return a==null?!1:a.toString().indexOf(b)==0},endsWith:String.prototype.endsWith?function(a,b){return a==null?!1:String.prototype.endsWith.call(a,b)}:function(a,b){return a==null?!1:a.toString().lastIndexOf(b)>=0&&a.toString().lastIndexOf(b)+b.length==a.length}}),QQWB.extend("Array",{isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},inArray:function(a,b){for(var c=0,d=a.length;c<d;c++)if(b===a[c])return!0;return!1},fromString:function(a,b,c){return QQWB.String.isString(a)?(b=b||"",c?a.split(b,c):a.split(b)):[]},fromArguments:function(a,b){return typeof a!="object"?[]:b?Array.prototype.slice.call(a,b):Array.prototype.slice.call(a)},toArray:function(a){return typeof a=="string"?a.split(""):typeof a=="object"?Array.prototype.slice.call(a,0):this.toArray(a.toString())},each:function(a,b){for(var c=0,d=a.length;c<d;c++)if(!1===b(c,a[c]))break},forEach:function(a,b,c){var d=[];if(a){var e=c||this;for(var f=0,g=a.length,h;f<g;f++)h=b.call(e,a[f],f,a),h!==undefined&&d.push(h)}return d},get:function(a,b){var c=a.length;if(Math.abs(b)<c)return b>=0?a[b]:a[c+b]}}),function(){var a;a=function(){var a=[],b,c,d,e={done:function(){if(!d){var c=arguments,f,g;b&&(g=b,b=0);for(var h=0,i=c.length;h<i;h++)f=c[h],QQWB.Array.isArray(f)?e.done.apply(e,f):QQWB.Function.isFunction(f)&&a.push(f);g&&e.resolveWith(g[0],g[1])}return this},resolveWith:function(e,f){if(!d&&!b&&!c){f=f||[],c=1;try{while(a[0])a.shift().apply(e,f)}finally{b=[e,f],c=0}}return this},resolve:function(){return e.resolveWith(this,arguments),this},isResolved:function(){return!!c||!!b},cancel:function(){return d=1,a=[],this}};return e},QQWB.extend("deferred",{deferred:function(b){var c,d=a(),e=a();return QQWB.extend(d,{fail:e.done,then:function(a,b){return d.done(a).fail(b),this},always:function(){return d.done.apply(d,arguments).fail.apply(this,arguments)},rejectWith:e.resolveWith,reject:e.resolve,isRejected:e.isResolved,promise:function(a){var b="done fail isResolved isRejected promise then always success error complete whatever".split(" ");if(a==null){if(c)return c;c=a={}}var e=b.length;while(e--)a[b[e]]=d[b[e]];return a}}),d.success=d.done,d.error=d.fail,d.complete=d.whatever=d.always,d.done(e.cancel).fail(d.cancel),delete d.cancel,b&&b.call(d,d),d},when:function(a){function f(a){return function(c){b[a]=arguments.length>1?QQWB.Array.fromArguments(arguments):c,--d||e.resolveWith(e,QQWB.Array.fromArguments(b))}}var b=arguments,c=b.length,d=c,e=c<=1&&a&&QQWB.Function.isFunction(a.promise)?a:QQWB.deferred.deferred();if(c>1)for(var g=0;g<c;g++)b[g]&&QQWB.Function.isFunction(b[g].promise)?b[g].promise().then(f(g),e.reject):--d,d||e.resolveWith(e,b);else e!==a&&e.resolveWith(e,c?[a]:[]);return e.promise()}}),QQWB.task=QQWB.when=QQWB.deferred.when}(),function(){var a={1:"\u53c2\u6570\u9519\u8bef",2:"\u9891\u7387\u53d7\u9650",3:"\u9274\u6743\u5931\u8d25",4:"\u5185\u90e8\u9519\u8bef"},b={4:"\u8fc7\u591a\u810f\u8bdd",5:"\u7981\u6b62\u8bbf\u95ee",6:"\u8bb0\u5f55\u4e0d\u5b58\u5728",8:"\u5185\u5bb9\u8fc7\u957f",9:"\u5185\u5bb9\u5305\u542b\u5783\u573e\u4fe1\u606f",10:"\u53d1\u8868\u592a\u5feb\uff0c\u9891\u7387\u9650\u5236",11:"\u6e90\u6d88\u606f\u4e0d\u5b58\u5728",12:"\u672a\u77e5\u9519\u8bef",13:"\u91cd\u590d\u53d1\u8868"};QQWB.extend("weibo.util",{parseRetCode:function(a){var b=a.match(/"ret":([^\}]+)/i)||a.match(/<ret>([^<]+)<\/ret>/i);return b?parseInt(b[1],10):b},parseErrorCode:function(a){var b=a.match(/"errcode":([^,]+)/i)||a.match(/<errcode>([^<]+)<\/errcode>/);return b?parseInt(b[1],10):b},parseErrorMsg:function(a){var b=a.match(/"msg":"([^"]+)"/)||a.match(/<msg>([^<]+)<\/msg>/);return b?b[1]:b},getErrorMessage:function(c){var d=this,e=[],f=a[this.parseRetCode(c)],g=b[this.parseErrorCode(c)],h=this.parseErrorMsg(c);return f&&e.push(f),g&&e.push(g),h&&e.push(h),e=e.join(","),e||"\u672a\u77e5\u9519\u8bef"},compat:function(a){return!QQWB.String.startsWith(a,"/")&&(a="/"+a),a.toLowerCase()}})}(),QQWB.extend("Object",{create:function(){return Object.create?Object.create:function(a,b){var c=function(){};return c.prototype=a,new c}}(),forEach:function(a,b,c,d){for(var e in a)d?b.call(c,a[e],e,a):a.hasOwnProperty(e)&&b.call(c,a[e],e,a)},isObject:function(a){return Object.prototype.toString.call(a)=="[object Object]"}}),QQWB.extend("XML",{isXML:function(a){},toString:function(a){return this.stringify(a)},stringify:function(a){var b;return window.ActiveXObject?b=a.xml:b=(new XMLSerializer).serializeToString(a),b},fromString:function(a){var b;if(window.ActiveXObject)b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a);else{var c=new DOMParser;b=c.parseFromString(a,"text/xml")}return b}},!0),function(){function b(a,b){var c=QQWB,d=c.String;return d.isString(a)||c.log.warn("bigtable inName is not a str"),d.isString(b)||c.log.warn("bigtable inKey is not a str"),["bt",a,b].join("_")}var a={};QQWB.extend("bigtable",{put:function(c,d,e){var f=b(c,d);return a[f]=e,a[f]},get:function(c,d,e){var f=b(c,d),g=a[f],h;return e!=h&&g==h?e:g},del:function(c,d){var e=b(c,d);try{delete a[e]}catch(f){a[e]=null}},has:function(c,d){var e=b(c,d);return a.hasOwnProperty(e)},_:function(){return a}}),QQWB.bigtable.set=QQWB.bigtable.put}(),QQWB.extend("time",{now:function(){return this.dateNow().getTime()},secondsNow:function(){return Math.round(this.now()/1e3)},dateNow:function(){return new Date},shortTime:function(a,b){var c;return a instanceof Date||(b=a,a=this.dateNow()),[a.getFullYear(),"/",a.getMonth(),"/",a.getDate()," ",(c=a.getHours())&&c<10?"0"+c:c,":",(c=a.getMinutes())&&c<10?"0"+c:c,":",(c=a.getSeconds())&&c<10?"0"+c:c].join("")}}),QQWB.extend("log",{CRITICAL:50,ERROR:40,WARNING:30,INFO:20,DEBUG:10,NOTSET:0,_level:0,setLevel:function(a){return this._level=a,this},debug:function(a){return this.DEBUG>=this._level&&this._out("DEBUG",a),this},info:function(a){return this.INFO>=this._level&&this._out("INFO",a),this},warning:function(a){return this.WARNING>=this._level&&this._out("WARNING",a),this},error:function(a){return this.ERROR>=this._level&&this._out("ERROR",a),this},critical:function(a){return this.CRITICAL>=this._level&&this._out("CRITICAL",a),this},_out:function(a,b){var c=QQWB,d=c.bigtable,e;output=[window.name?window.name:"",window.opener||window.name===d.get("oauthwindow","name")?"#":"",window!=window.parent?"*":"",c.name,": ","["+a+"] ",c.time.shortTime()+" ",b].join(""),e=d.get("log","latest"),e||(e=d.put("log","latest",[])),e.length>=200&&e.shift(),e.push(output),QQWB.debug&&window.console&&window.console.log(output)},last:function(a){var b=QQWB.bigtable.get("log","latest");return b&&a&&(b=b.slice(0,a)),b?b.join("\n"):""}}),QQWB.log.warn=QQWB.log.warning,QQWB.log.setLevel(QQWB.envs.loglevel),function(){var a=QQWB,b=a.bigtable,c=a.log,d=a.String,e="http://open.t.qq.com";b.put("uri","api",[e,"/api"].join("")),b.put("uri","auth",[e,"/oauth2_html/login.php"].join("")),b.put("uri","html5proxy",[e,"/open-js/proxy/proxy_v2.html"].join("")),b.put("uri","innerauthproxy",[e,"/open-js/proxy/proxy_v2.html"].join("")),b.put("uri","flashas3proxy",[e,"/open-js/proxy/proxy_as3_v2.swf"].join("")),b.put("uri","exchangetoken",[e,"/cgi-bin/exchange_token"].join("")),b.put("uri","autotoken",[e,"/cgi-bin/auto_token"].join("")),b.put("uri","gettokenbypt",[e,"/cgi-bin/oauth2/get_oauth2token_pt"].join("")),b.put("uri","innerauth",[e,"/cgi-bin/oauth2/inner_flow_page"].join("")),b.put("oauthwindow","name","authClientProxy_ee5a0f93"),b.put("oauthwindow","width","575"),b.put("oauthwindow","height","465"),b.put("innerauth","layerid","openjslayer"+QQWB.uid(5)),b.put("innerauth","originaldomain",document.domain),b.put("innerauth","rootdomain","qq.com"),b.put("innerauth","enabled",d.endsWith(document.domain,b.get("innerauth","rootdomain"))),b.put("innerauth","eventproxyready","InnerAuthProxyFrameReady"),b.put("innerauth","eventproxysizechange","InnerAuthProxySizeChange"),b.put("innerauth","eventproxysubmit","InnerAuthResult"),b.put("innerauth","eventproxycancel","InnerAuthRequestCancel"),b.put("cookie","domain",QQWB.envs.cookiedomain),b.put("cookie","path",QQWB.envs.cookiepath),b.put("cookie","accesstokenname","QQWBToken"),b.put("cookie","refreshtokenname","QQWBRefreshToken"),b.put("cookie","refreshtokenexpires",604800),b.put("cookie","getAccesstokenName",function(){return[b.get("cookie","accesstokenname"),b.get("base","appkey")].join("_")}),b.put("cookie","getRefreshtokenName",function(){return[b.get("cookie","refreshtokenname"),b.get("base","appkey")].join("_")}),b.put("nativeevent","userloggedin","UserLoggedIn"),b.put("nativeevent","userloginfailed","UserLoginFailed"),b.put("nativeevent","userloggedout","UserLoggedOut"),b.put("nativeevent","tokenready","tokenReady"),b.put("nativeevent","documentready","documentReady"),b.put("nativeevent","everythingready","everythingReady"),b.put("nativeevent","ready","ready"),b.put("solution","deferred",a.deferred.deferred()),b.put("solution","jscallbackname","onFlashReady_a1f5b4ce"),b.put("api","count",0),b.put("ping","urlbase","http://btrace.qq.com/collect"),b.put("ping","paramorder",["ftime","sIp","iQQ","sBiz","sOp","iSta","iTy","iFlow"]),b.put("ping","paramsep",";"),b.put("io","timeout",3e4),b.put("openjs","asynccallbackfunctionname","onOpenjsLoad"),b.put("boot","booting",!1),b.get("innerauth","enabled")&&(c.info("enter inner auth model, set domain to "+b.get("innerauth","rootdomain")),document.domain=b.get("innerauth","rootdomain")),QQWB.provide("init",function(a){var b=QQWB,c=b.bigtable,d=b.ping,e=b.log,f=b.String,g=b._token,h=b.dom,i="base",j=c.get("boot","booting"),k=c.get("innerauth","enabled"),l=location.href.match(/oauth2token=([^&]+)/i),m,n,o,p,q,r,s;j||(c.put("boot","booting",!0),c.get("boot","solution")()),r=c.get("boot","tokenready");if(c.get(i,"inited")===!0){e.warning("already initialized");return}e.debug("init signal has arrived"),a=b.extend({callbackurl:document.location.href.replace(location.search,"").replace(location.hash,""),pingback:!0,synclogin:!1,autoclose:!0,samewindow:!1,showappinfo:!0},a,!0),c.put(i,"pingback",a.pingback),c.put(i,"autoclose",a.autoclose),c.put(i,"samewindow",a.samewindow),c.put(i,"synclogin",a.synclogin);if(typeof a.appkey!="undefined")e.info("client id(appkey) is "+a.appkey),c.put("base","appkey",a.appkey);else{e.critical("client id(appkey) is NOT optional");return}return l&&(e.info("resolve token from url"),m=location.href.match(/wb_name=([^&]+)/i),n=location.href.match(/wb_nick=([^&]+)/i),g.resolveResponse(decodeURIComponent(l[1])+(m?"&wb_name="+m[1]:"")+(n?"&wb_nick="+n[1]:""),!1)),o=g.getAccessToken(),p=g.getAccessToken(!0),q=g.getRefreshToken(),s=document.cookie,k?!o&&s&&(/uin=([^;]+)/.test(s)&&/skey=([^;]+)/.test(s)||/luin=([^;]+)/.test(s)&&/lskey=([^;]+)/.test(s))&&(r.lock("start auto login"),c.get("solution","deferred").complete(function(){var b=c.get("solution","frame");b&&b.contentWindow&&b.contentWindow.getToken?b.contentWindow.getToken(c.get("base","appkey"),!a.showappinfo).success(function(a){g.resolveResponse(a,!1)}).error(function(a,b,c,d){e.error(["auto login failed,",a,", ",b,", ",f.trim(d)].join(""))}).complete(function(){r.unlock("done auto login")}):(e.error("retrieve inner auth token error, proxy frame not loaded"),r.unlock("failed to load innerauth proxy frame, auto login failed"))})):(e.info("client proxy uri is "+a.callbackurl),c.put("uri","redirect",a.callbackurl),q&&!o&&p&&(r.lock("exchange token"),e.info("exchanging refresh token to access token..."),g.exchangeForToken(function(a){r.unlock("token exchanged")})),a.synclogin&&!q&&!o&&(r.lock("start auto login"),g.loadSyncLoginToken().success(function(a){e.info("auto login success result cached "+a),c.put("synclogin","responsetext",a)}).error(function(a,b,c,d){e.error(["auto login failed,",a,", ",b,", ",d].join(""))}).complete(function(){r.unlock("done auto login")}))),r.unlock("init is called"),d&&a.pingback&&d.pingInit(),function(){function f(){var g=!!a._token.getAccessToken(),h;e&&b.info("cancel the **OLD** maintain token schedule"),e&&clearTimeout(e),g?(h=parseInt(c.get(d.get("cookie","getAccesstokenName")()).split("|")[1],10)-a.time.now()-15e3,b.info("scheduled to exchange token after "+h+"ms"),e=setTimeout(function(){a._token.exchangeForToken(function(){f()})},h)):(e&&b.info("cancel the exchange token schedule"),e&&clearTimeout(e))}var a=QQWB,b=a.log,c=a.cookie,d=a.bigtable,e;a.bind(d.get("nativeevent","tokenready"),f),a.bind(d.get("nativeevent","userloggedin"),f),a.bind(d.get("nativeevent","userloginfailed"),f),a.bind(d.get("nativeevent","userloggedout"),f)}(),g.compatOldVersion(),c.put(i,"inited",!0),b})}(),function(){var a=QQWB,b=a.bigtable,c=a.String,d=a.queryString,e=a.log,f=a.Object,g=a.time,h=b.get("io","timeout"),i,j,k,l,m=0,n,o,p,q,r;p=function(){return a.Object.create({ajax:a.ajax,jsonp:a.jsonp,script:a.script})},q=function(a,b){return b=b||"unknown",a.data&&(f.isObject(a.data)?a.data=d.encode(a.data):c.isString(a.data)?a.data=c.trim(a.data).replace(/^&+/,""):e.warn("["+b+"] ignored invalid params data "+default_opts.data)),c.trim(a.type).toUpperCase()=="GET"&&(a.url=joinUrlWithData(a.url,a.data)),c.trim(a.type).toUpperCase()=="GET"&&!a.cache&&(a.url=joinUrlWithData(a.url,"nocache=openjs"+QQWB.uid(5))),a},joinUrlWithData=function(a,b){var c=a.lastIndexOf("?"),d;return c==-1?d=[a,"?",b]:c==a.length-1?d=[a,b]:d=[a,"&",b],d.join("")},j=function(a){var b;return{send:function(c){var d=g.now(),f=document.head||document.getElementsByTagName("head")[0]||document.documentElement,i=setTimeout(function(){e.error("load script "+a.url+" timeout"),c(599,"timeout",g.now()-d),c=null},h);b=document.createElement("script"),b.async="async",a.charset&&(b.charset=a.charset),b.src=a.url,b.onload=b.onreadystatechange=function(a,e){if(e||!b.readyState||/loaded|complete/.test(b.readyState)){var h;clearTimeout(i),b.onload=b.onreadystatechange=null,f&&b.parentNode&&f.removeChild(b),b=null,c&&(h=g.now()-d,e?c(-1,"aborted",h):c(200,"success",h),c=null)}},b.onerror=function(a){clearTimeout(i),c&&c(500,"server error",g.now()-d),c=null},f.insertBefore(b,f.firstChild)},abort:function(){b&&b.onload(0,1)}}},k=function(b){var c;return{send:function(d){var f=g.now(),i=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),j=setTimeout(function(){e.error("ajax timeout, url "+b.url),d(599,"timeout",g.now()-f),d=null},h);b.async||(b.async="async"),b.username?i.open(b.type,b.url,b.async,b.username,b.password):i.open(b.type,b.url,b.async);try{b.type.toUpperCase()=="POST"&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("X-Requested-From","openjs"+a.version)}catch(k){e.warning("set header error "+k)}i.send(b.data||null),c=function(h,k){var l,m,n,o,p,q;try{if(c&&(k||i.readyState===4)){c=null;if(k)i.readyState!==4?(clearTimeout(j),i.abort(),d&&d(-1,"aborted",g.now()-f),d=null):e.debug("abort ajax failed, already finish");else{clearTimeout(j),l=i.status,n=i.getAllResponseHeaders()||"",o={},q=i.responseXML,q&&q.documentElement&&(o.xml=q),o.text=i.responseText;try{m=i.statusText}catch(r){m=""}l===1223&&(l=204),b.dataType.toLowerCase()=="json"?p=a.JSON.fromString(o.text):b.dataType.toLowerCase()=="xml"?p=o.xml:p=o.text}d(l,m,g.now()-f,p,o.text,n,b.dataType),d=null}}catch(s){clearTimeout(j),e.error("caught exception "+[s.type,s.message].join(" ")+" in ioajax"),d(-2,"exception "+s,g.now()-f),d=null}},!b.async||i.readyState===4?c():i.onreadystatechange=c},abort:function(){c&&c(0,1)}}},l=function(a){var c;return{send:function(d){var f=g.now(),i=b.get("solution","flashmovie"),j="as3callbacktkt"+ ++m,k=setTimeout(function(){e.error("flash as3 timeout, url "+a.url),d(599,"timeout",g.now()-f),d=null},h);c=function(b,h){var i,j,l,m,n,o;try{c&&(c=null,clearTimeout(k),h?(d&&d(-1,"aborted",g.now()-f),d=null):(i=this.httpStatus,j=this.httpStatus==200?"ok":"",l="",m={},m.text=this.httpResponseText,a.dataType.toLowerCase()=="json"?n=QQWB.JSON.fromString(m.text):a.dataType.toLowerCase()=="xml"?n=QQWB.XML.fromString(m.text):n=m.text),d(i,j,g.now()-f,n,m.text,l,a.dataType),d=null)}catch(p){clearTimeout(k),e.error("caught exception "+[p.type,p.message].join(" ")+" in ioas3"),d(-2,"exception "+p,g.now()-f),d=null}},b.put("io",j,c),i&&i.httpRequest?i.httpRequest(a.url,a.data,a.type,j):e.critical("flash transportation object error")},abort:function(){c&&c(0,1)}}},window.onFlashRequestComplete_8df046=function(a){var c,d;if(!a.ticket){e.error("ticket doesn't exists in response");return}c=b.get("io",a.ticket),d=a.srcEvent,c.readyState||(c.readyState=0),/httpStatus/i.test(d.type)?(c.httpStatus=d.status,c.readyState++):/error/i.test(d.type)?(c.httpError=d.type,c.readyState++):/complete/i.test(d.type)&&(c.httpResponseText=d.target.data,c.readyState++),c.readyState==2&&(c.call(c),b.del("io",a.ticket))},o=function(a){return function(b,c,d,e,f,g,h){var i,j;b!==200?(b=2e6+Math.abs(b?b:0),a.reject(b,c,d,"")):typeof (i=QQWB.weibo.util.parseRetCode(f))=="number"&&0!==i?(j=QQWB.weibo.util.parseErrorCode(f),b=1e6+i*1e3+500+(j?j:0),a.reject(b,QQWB.weibo.util.getErrorMessage(f),d,f)):a.resolve(b,c,d,e,g,h)}},r=function(a){return function(b,c,d,e,f,g,h){b!==200?a.reject(b,c,d,f):a.resolve(e,d,f)}},QQWB.extend("io",{flashAjax:function(a){var b=QQWB.deferred.deferred(),c={type:"get",dataType:"json"};return QQWB.extend(c,a,!0),l(c).send(o(b)),b.promise()},ajaxWith:function(a,b,c){var d=QQWB,e=d.String,f=QQWB.deferred.deferred(),g={type:"get",dataType:"json",cache:!1};return QQWB.extend(g,a,!0),g.url?(g.type=e.trim(g.type),g=q(g,"script"),g.dataType=e.trim(g.dataType),g.type.toUpperCase()=="GET"&&g.data&&(g.url=joinUrlWithData(g.url,g.data),g.cache||(g.url=joinUrlWithData(g.url,"nocache=openjs"+QQWB.uid(5)))),k(g).send(b(f)),f.promise(c)):(f.reject(-2,"invalid url",0),f.promise(c))},apiAjax:function(a){return QQWB.io.ajaxWith(a,o)},ajax:function(a){return QQWB.io.ajaxWith(a,r,p())},script:function(a){var b=QQWB,c=b.String,d=p(),e=QQWB.deferred.deferred(),f={charset:"utf-8",cache:!0,type:"get"};return QQWB.extend(f,a,!0),f.url?(f=q(f,"script"),j(f).send(function(a,b,c){a!==200?e.reject(a,b,c):e.resolve(a,b,c)}),e.promise(d)):(e.reject(-2,"invalid url",0),e.promise(d))},jsonp:function(a){var b=QQWB,c=b.String,d=p(),f=QQWB.deferred.deferred(),g="jsonp_"+QQWB.uid(5),h=window.callbackName,i,k={dataType:"json",charset:"utf-8",cache:!1,type:"get"};return QQWB.extend(k,a,!0),k.url?(k=q(k,"jsonp"),k.url=joinUrlWithData(k.url,"callback="+g),window[g]=function(a){var b=a;try{k.dataType.toLowerCase()==="json"?b=QQWB.JSON.fromString(a):k.dataType.toLowerCase()==="xml"&&(b=QQWB.XML.fromString(a))}catch(c){e.error("caught exception "+[c.type,c.message].join(" ")+" in ioajax"),f.reject(-2,"exception "+c,i)}f.resolve(b,i),window[g]=h},j(k).send(function(a,b,c){a!==200&&f.reject(a,b,c),i=c}),f.promise(d)):(f.reject(-2,"invalid url",0),f.promise(d))}}),QQWB.ajax=QQWB.io.ajax,QQWB.jsonp=QQWB.io.jsonp,QQWB.script=QQWB.io.script}(),QQWB.provide("api",function(a,b,c,d,e){var f=QQWB,g=f.Array,h=f.String,i=f.JSON,j=f.XML,k=f.bigtable,l=f.log,m=f.queryString,n=f.io,o=k.get("api","count",0),p=k.get("solution","deferred"),q=k.get("solution","name"),r=c,s={json:!0,xml:!0},t=f.deferred.deferred(),u={api:QQWB.api},v=QQWB.Object.create(u),w=t.promise(v),x,y,z,A;a=f.weibo.util.compat(a),b=b||{},c=(c||"json").toLowerCase(),d=d||"GET",e=e||{},x=e.appkey||e.clientid||k.get("base","appkey"),y=e.accesstoken||e.token||f._token.getAccessToken(),r in s||(r="json"),b.oauth_consumer_key=x,b.oauth_token=y,b.oauth_version="2.0",b.format=r;if(!x)return l.error("appkey can not be empty"),t.reject(-1,"appkey cant not be empty",0),w;if(a=="/t/add_pic")return l.error("/t/add_pic is not supported yet"),t.reject(-1,"\u6682\u4e0d\u652f\u6301\u6b64\u63a5\u53e3\uff0c\u8bf7\u4f7f\u7528 t/add_pic_url \u4ee3\u66ff",0),w;y||l.warn("accesstoken is empty");if(!p.isResolved()&&!p.isRejected())return l.warning("api call cached, waiting solution ready ..."),p.promise().done(function(){l.info("invoking cached api call "+a+"..."),f.api(a,b,c,d,e).success(function(){t.resolveWith(t,arguments)}).error(function(){t.rejectWith(t,arguments)})}).fail(function(){l.error("can't invoking cached api call "+a+"..."),t.rejectWith(t,arguments)}),w;if(!p.isResolved())return p.fail(function(){l.error(arguments[1]),t.rejectWith(t,arguments)}),w;k.put("api","count",++o),l.info("["+o+"] sending weibo request...");switch(q){case"innerauth":z=k.get("solution","frame"),z&&z.contentWindow&&z.contentWindow.apiAjax?z.contentWindow.apiAjax(a,b,c,d).complete(function(){arguments[0]!==200?t.rejectWith(t,arguments):t.resolve(arguments[3],arguments[2],arguments[4])}):(l.error(-1,"proxy frame not found"),t.reject(-1,"proxy frame not found"));break;case"html5":z=k.get("solution","frame"),z?(A=k.get("api","ondataback"),A||(A=k.put("api","ondataback",function(a){var b,c,d,e;k.get("uri","html5proxy").indexOf(a.origin)!==0?l.warn("ignore data from origin "+a.origin):(b=i.fromString(a.data),c=b.id,e=b.data,d=k.get("api","resultdeferred"+c),d?(e[0]!==200?d.rejectWith(d,e):(e[5]=="_xml_"&&(e[3]=j.fromString(e[3])),d.resolve(e[3],e[2],e[4])),k.del("api","resultdeferred"+c)):l.error("invalid api request id "+c))}),window.addEventListener?window.addEventListener("message",A,!1):window.attachEvent&&window.attachEvent("onmessage",A)),k.put("api","resultdeferred"+o,t),setTimeout(function(){z.contentWindow.postMessage(i.stringify({id:o,data:[a,b,c,d]}),k.get("uri","html5proxy"))},0)):(l.error(-1,"proxy frame not found"),t.reject(-1,"proxy frame not found"));break;case"as3":function B(a,b,c,d){var e={type:h.trim(d.toUpperCase()),url:k.get("uri","api")+a,data:m.encode(b),dataType:h.trim(c.toLowerCase())};return e.type=="GET"&&(e.url+=e.data?"?"+e.data:"",delete e.data),n.flashAjax(e)}B(a,b,c,d).complete(function(){arguments[0]!==200?t.rejectWith(t,arguments):t.resolve(arguments[3],arguments[2],arguments[4])});break;default:t.reject(-1,"invalid solutionName "+q)}return w.complete(function(){l.info("*["+o+"] done")}),w}),function(){var a=QQWB,b=a.Object,c=a.Array,d={},e;e={add:function(a){return this.tmpl.push(a),this},wrapTag:function(a){var b=arguments,c=[],d=[];for(var e=0,f=arguments.length;e<f;e++)c.push(["<",b[e],">"].join("")),d.push(["</",b[e],">"].join(""));return c.length>0&&this.tmpl.splice(0,0,c.join("")),d.length>0&&this.tmpl.push(d.join("")),this},reset:function(a,b){return!a&&!b?(this.tmpl=[],this.datas={}):(a&&(this.tmpl=[]),b&&(this.datas={})),this},data:function(d,e){var f,g,h=arguments;h.length>3&&(d=c.fromArguments(h),e=d.splice(-1,1),e=e.length>0?e[0]:!1);if(b.isObject(d))a.extend(this.datas,d,e);else if(c.isArray(d))for(var i=0,j=d.length;i<j;i+=2){f=d[i],i+1<j&&(g=d[i+1]);if(e||!(f in this.datas))this.datas[f]=g}else f=h[0],g=h[1],e=h[2],f&&(e||!(f in this.datas))&&(this.datas[f]=g);return this},renderWith:function(b,c){this.data.apply(this,arguments);try{return a.template.renderTemplate(this.tmpl.join(""),this.datas)}catch(d){throw msg=["render template ",this.name," error, ",d].join(""),new Error(msg)}return""},render:function(){return this.renderWith(this.datas)},toString:function(){try{return this.render()}catch(a){return""}}},a.provide("template",function(a){var c=b.create(e);return c.tmpl=[],c.datas={},c.name=a||"unknown",c}),a.extend("template",{renderTemplate:function(a,b){function c(a,b){var e=/\W/.test(a)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):d[a]=d[a]||c(document.getElementById(a).innerHTML);return b?e(b):e}return c(a,b)}})}(),QQWB.extend("queryString",{encode:function(a,b,c,d){var e=/%20/g,f=b||"&",g=c||encodeURIComponent,h=[],i=[],j,k;for(j in a)if(a.hasOwnProperty(j)){k=a[j];if(k!==null&&typeof k!="undefined"){j=g(j).replace(e,"+"),k=g(k).replace(e,"+");if(!d)h.push(j+"="+k);else for(var l=0,m=d.length;l<m;l++)d[l]===j&&(h[l]=j+"="+k)}}for(var n=0,o=h.length;n<o;n++)typeof h[n]!="undefined"&&i.push(h[n]);return h=i,i=null,h.join(f)},decode:function(a,b,c){var d=c||decodeURIComponent,e=b||"&",f=a.split(e),g={},h;for(var i=0,j=f.length;i<j;i++)h=f[i].split("=",2),h&&h[0]&&(g[d(h[0])]=d(h[1]));return g}});var JSON;JSON||(JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),QQWB.extend("JSON",{fromString:function(a){if(!a||!QQWB.String.isString(a))return{};a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(window.JSON&&window.JSON.parse)a=window.JSON.parse(a);else if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))a=(new Function("return "+data))();else throw new SyntaxError("Invalid JSON: "+a);return a},stringify:function(a){return a==null?"":window.JSON.stringify(a)},toString:function(a){return QQWB.JSON.stringify(a)},parse:function(a){return a==null?{}:window.JSON.parse(a)}},!0),function(){function k(a){a=a.toLowerCase();var b,c;return b=function(){var a,b=3,c=document.createElement("div"),d=c.getElementsByTagName("i");while(c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",d[0]);return b>4?b:a}(),b?{browser:"msie",version:b}:(c=e.exec(a)||d.exec(a)||a.indexOf("compatible")<0&&f.exec(a)||[],{browser:c[1]||"unknown",version:c[2]||"0"})}function l(){var a,b;for(a in j)j.hasOwnProperty(a)&&(b=j[a](),b&&(h[a]=b))}function m(){var a=navigator.appVersion,b={},c="unknown";return a.indexOf("Win")!=-1&&(c="windows"),a.indexOf("Mac")!=-1&&(c="mac"),a.indexOf("X11")!=-1&&(c="unix"),a.indexOf("Linux")!=-1&&(c="linux"),b[c]=!0,b.name=c,b}function n(){return document.compatMode=="BackCompat"?{quirks:!0}:{standard:!0}}function o(){return QQWB.bigtable.get("browser","detectviewportsize")()}var a,b,c=navigator.userAgent,d=/(opera)(?:.*version)?[ \/]([\w.]+)/,e=/(webkit)[ \/]([\w.]+)/,f=/(mozilla)(?:.*? rv:([\w.]+))?/,g=/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,h={},i=["Webkit","Moz","O","ms","khtml"],j={cookie:function(){var a=navigator.cookieEnabled;if(a&&QQWB.browser.webkit){var b="COOKIE_TEST_"+QQWB.uid();document.cookie=b+"="+1+"; domain=; path=;",document.cookie.indexOf(b)<0?a=!1:document.cookie=b+"="+"; expires="+(new Date(1970,1,1)).toUTCString()+"; domain=; path=;"}return!a&&QQWB.log.warn("This browser doesn't support cookie or cookie isn't enabled"),a},flash:function(){var a,b,c,d,e;if(typeof navigator.plugins!="undefined"&&typeof navigator.plugins["Shockwave Flash"]=="object")a=navigator.plugins["Shockwave Flash"].description,b=typeof 
navigator.mimeTypes!="undefined"&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin,a&&b&&(a=a.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),d=[],d[0]=parseInt(a.replace(/^(.*)\..*$/,"$1"),10),d[1]=parseInt(a.replace(/^.*\.(.*)\s.*$/,"$1"),10),d[2]=/[a-zA-Z]/.test(a)?parseInt(a.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof window.ActiveXObject!="undefined"){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){}c&&(a=c.getVariable("$version"),a?(a=a.split(" ")[1].split(","),d=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)]):d=[0,0,0])}if(d)return e={version:d.join(".")},d[0]>=9&&(e.externalinterface=!0),e},userdata:function(){return QQWB.browser.msie},postmessage:function(){return!!window.postMessage&&(QQWB.browser.msie&&parseInt(QQWB.browser.version,10)<8?!1:!0)},canvas:function(){var a=document.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},webgl:function(){return!!window.WebGLRenderingContext},geolocation:function(){return!!navigator.geolocation},websqldatabase:function(){return!!window.openDatabase},indexeddb:function(){for(var a=0,b=i.length;a<b;a++)if(window[i[a].toLowerCase()+"IndexedDB"])return!0;return!!window.indexedDB},websocket:function(){for(var a=0,b=i.length;a<b;a++)if(window[i[a].toLowerCase()+"WebSocket"])return!0;return!!window.WebSocket},localstorage:function(){return!!window.localStorage&&!!localStorage.getItem},sessionstorage:function(){return!!window.sessionStorage&&!!sessionStorage.getItem},webworker:function(){return!!window.Worker},applicationcache:function(){return!!window.applicationCache}};QQWB.bigtable.put("browser","detectviewportsize",function(){var a=window,b="inner",c=document.compatMode;return"innerWidth"in a||(b="client",a=c=="BackCompat"?document.body:document.documentElement),a?{width:a[b+"Width"],height:a[b+"Height"]}:{width:0,height:0}}),a=k(c),window.addEventListener?window.addEventListener("resize",function(){QQWB.extend("browser.viewport",o(),!0)},!1):window.attachEvent&&window.attachEvent("onresize",function(){QQWB.extend("browser.viewport",o(),!0)}),QQWB.extend("browser",{version:a.version}),QQWB.browser[a.browser]=!0,QQWB.browser.engine=a.browser,l(),QQWB.extend("browser.feature",h),b=g.exec(navigator.userAgent||navigator.vendor||window.opera||""),b?(QQWB.extend("browser.platform",{name:b[0],mobile:!0}),QQWB.browser.platform[b[0]]=!0):QQWB.extend("browser.platform",{name:"desktop",desktop:!0}),QQWB.extend("browser.os",m()),QQWB.extend("browser.rendererMode",n()),QQWB.extend("browser.viewport",o())}(),QQWB.browser.feature.cookie?QQWB.extend("cookie",{set:function(a,b,c,d,e,f){var g,h,i;f=f||escape;if(typeof c=="undefined"||c===null)c=-1;return g=e?"domain="+e:"",h=d?"path="+d:"",i="",c===0?i="expires="+(new Date(1970,1,1)).toUTCString():c>0&&(i="expires="+(new Date((new Date).getTime()+c*1e3)).toUTCString()),document.cookie=[a+"="+f(b),i,h,g].join("; "),QQWB},get:function(a,b,c){b=b||unescape,a+="=",cookies=(document.cookie||"").split(/\s*;\s*/);for(var d=0,e=cookies.length;d<e;d++){var f=cookies[d];if(f.indexOf(a)===0)return b(f.substr(a.length))}return c},del:function(a,b,c){return QQWB.cookie.set(a,"",0,b,c),document.cookie.indexOf(a+"=")>=0&&QQWB.log.warning("cookie may not be deleted as you expected"),QQWB}}):QQWB.log.debug("cookie isn't support or be enabled"),QQWB.extend("_token",{setAccessToken:function(a,b,c,d){var e=QQWB,f=e.bigtable,g=e.cookie,h=e.time,i;return i=this.getTokenUser(!0),g.set(f.get("cookie","getAccesstokenName")(),[a,h.now()+b*1e3,c||i&&i.name||"",d||i&&i.nick||""].join("|"),f.get("cookie","refreshtokenexpires"),f.get("cookie","path"),f.get("cookie","domain")),e},getAccessToken:function(a){var b=QQWB,c=b.bigtable,d=b.cookie,e=b.time,f;f=d.get(c.get("cookie","getAccesstokenName")());if(f){f=f.split("|",2);if(a||parseInt(f[1],10)>e.now())return f[0]}},getTokenUser:function(a){var b=QQWB,c=b.bigtable,d=b.cookie,e=b.time,f;f=d.get(c.get("cookie","getAccesstokenName")());if(f){f=f.split("|",4);if(a||parseInt(f[1],10)>QQWB.time.now())return{name:f[2],nick:f[3]}}},clearAccessToken:function(){var a=QQWB,b=a.bigtable,c=a.cookie;return c.del(b.get("cookie","getAccesstokenName")(),b.get("cookie","path"),b.get("cookie","domain"))},setRefreshToken:function(a){var b=QQWB,c=b.bigtable,d=b.cookie;return d.set(c.get("cookie","getRefreshtokenName")(),a,c.get("cookie","refreshtokenexpires"),c.get("cookie","path"),c.get("cookie","domain")),b},getRefreshToken:function(){return QQWB.cookie.get(QQWB.bigtable.get("cookie","getRefreshtokenName")())},clearRefreshToken:function(){return QQWB.cookie.del(QQWB.bigtable.get("cookie","getRefreshtokenName")(),QQWB.bigtable.get("cookie","path"),QQWB.bigtable.get("cookie","domain"))},exchangeForToken:function(a){var b=QQWB,c=b.bigtable,d=b.queryString,e=b.log,f=b.io,g=b.String,h=c.get("base","appkey");return f.jsonp({url:c.get("uri","exchangetoken"),dataType:"text",data:d.encode({response_type:"token",client_id:h,scope:"all",state:"1",refresh_token:this.getRefreshToken(),access_token:this.getAccessToken(!0)})}).success(function(a){var c=a;g.isString(a)&&(a=d.decode(a)),a.access_token?(!a.expires_in&&e.error("accesstoken expires_in not returned"),!a.wb_name&&e.warning("weibo username not retrieved, will not update username"),!a.wb_nick&&e.warning("weibo nick not retrieved, will not update nick"),b._token.setAccessToken(a.access_token,parseInt(a.expires_in,10),a.wb_name,a.wb_nick),a.refresh_token?b._token.setRefreshToken(a.refresh_token):e.warning("refresh token not retrieved"),e.info("exchange token succeed")):a.error?e.error("exchange token error "+a.error):e.error("unexpected result returned from server "+c+" while exchanging for new accesstoken")}).error(function(a,b){a===404?e.error("exchange token has failed, script not found"):e.error("exchange token has failed, "+b)}).complete(function(b,c,d){a&&a(b,c,d)}),b},loadSyncLoginToken:function(){var a=QQWB,b=a.bigtable,c=a.queryString,d=a.io;return d.jsonp({url:b.get("uri","autotoken"),dataType:"text",data:c.encode({response_type:"token",client_id:b.get("base","appkey"),scope:"all",state:"1"})})},resolveResponse:function(a,b){var c=QQWB,d=c.bigtable,e=c.queryString,f=c.log,g=c.String,h,i=g.isString(a)?e.decode(a):a;return f.debug(["resolve response ",T.JSON.stringify(i)].join("")),i.access_token?(!i.expires_in&&f.error("token expires_in not retrieved"),!i.wb_name&&f.warning("weibo username not retrieved"),!i.wb_nick&&f.warning("weibo usernick not retrieved"),c._token.setAccessToken(i.access_token,parseInt(i.expires_in,10),i.wb_name,i.wb_nick),i.refresh_token?c._token.setRefreshToken(i.refresh_token):f.error("refresh token not retrieved"),b&&(h=c.loginStatus(),h?(f.info("user "+h.name||"unknown logged in"),c.trigger(d.get("nativeevent","userloggedin"),h)):f.error("resolve response error, loginStatus is "+h))):i.error||i.errorMsg?(f.error("login error occurred "+i.error),b&&(i.error=i.error||i.errorMsg,i.message=i.error,b&&c.trigger(d.get("nativeevent","userloginfailed"),i))):(f.error("unexpected result returned from server "+a),b&&(i={},i.message=i.error="server error",b&&c.trigger(d.get("nativeevent","userloginfailed"),i))),c},compatOldVersion:function(){var a=QQWB,b=a.bigtable,c=a.log,d=a._token,e=a.cookie,f=parseFloat(QQWB.version,10)>=2,g=b.get("cookie","path"),h=b.get("cookie","domain"),i=b.get("cookie","refreshtokenexpires"),j=e.get(b.get("cookie","accesstokenname")),k=e.get(b.get("cookie","refreshtokenname"));f&&(j||k)&&(j&&(e.set(b.get("cookie","getAccesstokenName")(),j,i,g,h),e.del(b.get("cookie","accesstokenname"),g,h),c.info("accesstoken storage has been updated")),k&&(e.set(b.get("cookie","getRefreshtokenName")(),k,i,g,h),e.del(b.get("cookie","refreshtokenname"),g,h),c.info("refreshtoken storage has been updated")))}}),function(){var a=QQWB,b=a.bigtable,c=a.log,d=a._token,e=a.cookie,f=a.String,g,h;h={show:function(){QQWB.documentReady(function(){var c=b.get("innerauth","layerid"),d=b.get("base","appkey"),e=b.get("uri","innerauth"),f='frameBorder="0" width="100%" height="100%" scrolling="no"',g=document.getElementById(c),h=a.browser,i,j,k,l;g||(g=QQWB.dom.createElement("div",{id:b.get("innerauth","layerid"),style:["position:absolute;padding:5px;overflow:hidden;z-index:999;visibility:hidden;",h.msie&&h.version<9?'filter: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#4c000000", EndColorStr="#4c000000");':"background-color:rgba(0,0,0,0.3);"].join(""),innerhtml:['<iframe src="',e,"?appkey=",d,'" ',f,"></iframe>"].join("")}),k=function(){QQWB.trigger(b.get("innerauth","eventproxysizechange"),i,j)},l=function(){g.parentNode.removeChild(g),QQWB.unbind(b.get("innerauth","eventproxysizechange"),!1),window.removeEventListener?window.removeEventListener("resize",k):window.detachEvent&&window.detachEvent("onresize",k)},QQWB.once(b.get("innerauth","eventproxysubmit"),function(a){QQWB._token.resolveResponse(a,!0),l()}),QQWB.once(b.get("innerauth","eventproxycancel"),function(){QQWB._token.resolveResponse("error=user_refused",!0),l()}),QQWB.bind(b.get("innerauth","eventproxysizechange"),function(a,b){var c=document.documentElement.scrollTop||document.body.scrollTop;i=a,j=b,g.style.width=a+"px",g.style.height=b+"px",g.style.left=Math.max(0,h.viewport.width-a)/2+"px",g.style.top=c+Math.max(0,h.viewport.height-b)/2+"px",g.style.visibility="visible"}),window.addEventListener?window.addEventListener("resize",k):window.attachEvent&&window.attachEvent("onresize",k),document.body.appendChild(g))})}},g=function(){var d=!1,e=null;return{show:function(){var f=b.get("oauthwindow","width"),g=b.get("oauthwindow","height"),h=b.get("oauthwindow","name"),i=b.get("uri","auth"),j="toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=yes,status=no",k=b.get("base","appkey"),l=b.get("base","autoclose"),m=b.get("base","samewindow"),n,o,p,q;if(!d){n=(window.screenX||window.screenLeft)+Math.max(0,(window.outerWidth||document.documentElement.clientWidth)-f)/2,o=(window.screenY||window.screenTop)+Math.max(0,(window.outerHeight||document.documentElement.clientHeight)-g)/2,p=a.queryString.encode({response_type:"token",client_id:k,redirect_uri:b.get("uri","redirect"),scope:"all",status:0}),q=["width="+f,"height="+g,"left="+n,"top="+o].join(",");if(m){window.name=h,window.location.href=i+"?"+p;return}e=window.open(i+"?"+p,h,[q,j].join(",")),d=!0,function(){var a=QQWB,b=a._token,f,g,h=a.queryString;if(!e){errormsg="browser blocked popup authorize window",c.error(errormsg),b.resolveResponse("error="+errormsg,!0);return}if(e.closed){b.resolveResponse("error=access_denied",!0),d=!1,e=null;return}try{f=e.location&&e.location.href}catch(i){f=null}if(f&&f!="about:blank"){g=f.lastIndexOf("#"),f=g==-1?"":f.slice(g+1);if(f){f=h.decode(f),b.resolveResponse(f,!0),d=!1,l&&e.close(),e=null;return}}setTimeout(arguments.callee,0)}()}else e&&e.focus()}}}(),QQWB.extend("auth",{login:function(e,f){var i=b.get("base","inited"),j=b.get("innerauth","enabled"),k=b.get("base","synclogin"),l=a.auth.loginStatus(),m,n,o;i||(m=a.name+" not initialized, call T.init() to initialize",c.critical(m));if(m&&f)return f({message:m}),a;if(l&&e)return e(l),a;if(!j&&k){n=b.get("synclogin","responsetext");if(n){c.debug("using prefetched token ..."),d.resolveResponse(n,!1),l=a.auth.loginStatus();if(l)return c.debug("synclogin succeed"),e&&e(l),a}c.debug("synclogin failed, fallback to login window")}if(e||f)o=function(d){d.access_token&&e?e(d):d.error&&f?f(d):c.error("wired result of T.login "+QQWB.JSON.stringify(d)),a.unbind(b.get("nativeevent","userloggedin"),o),a.unbind(b.get("nativeevent","userloginfailed"),o),o=null},a.bind(b.get("nativeevent","userloggedin"),o),a.bind(b.get("nativeevent","userloginfailed"),o);return j?h.show():g.show(),a},logout:function(f){var g=a.loginStatus(),h=b.get("innerauth","enabled"),i=b.get("innerauth","rootdomain");return c.info("logging out user"),g?(d.clearAccessToken(),d.clearRefreshToken(),b.del("synclogin","responsetext"),c.info("user "+(g.name||"unknown")+" logged out")):c.warning("oops, user not logged in"),h&&(e.del("uin","/",i),e.del("skey","/",i),e.del("luin","/",i),e.del("lskey","/",i)),f&&f(),a.trigger(b.get("nativeevent","userloggedout")),a},loginStatus:function(a){var b=d.getAccessToken(),c=d.getTokenUser(),e;return b&&(e={access_token:b,name:c.name,nick:c.nick}),a&&a(e),e}}),QQWB.login=QQWB.auth.login,QQWB.logout=QQWB.auth.logout,QQWB.loginStatus=QQWB.auth.loginStatus}(),function(){function q(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}i.nodeType===1&&!f&&(i.sizcache=c,i.sizset=g);if(i.nodeName.toLowerCase()===b){j=i;break}i=i[a]}d[g]=j}}}function r(a,b,c,d,e,f){for(var g=0,i=d.length;g<i;g++){var j=d[g];if(j){var k=!1;j=j[a];while(j){if(j.sizcache===c){k=d[j.sizset];break}if(j.nodeType===1){f||(j.sizcache=c,j.sizset=g);if(typeof b!="string"){if(j===b){k=!0;break}}else if(h.filter(b,[j]).length>0){k=j;break}}j=j[a]}d[g]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,b=0,c=Object.prototype.toString,d=!1,e=!0,f=/\\/g,g=/\W/;[0,0].sort(function(){return e=!1,0});var h=function(b,d,e,f){e=e||[],d=d||document;var g=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return e;var k,l,n,o,p,q,r,t,u=!0,v=h.isXML(d),w=[],x=b;do{a.exec(""),k=a.exec(x);if(k){x=k[3],w.push(k[1]);if(k[2]){o=k[3];break}}}while(k);if(w.length>1&&j.exec(b))if(w.length===2&&i.relative[w[0]])l=s(w[0]+w[1],d);else{l=i.relative[w[0]]?[d]:h(w.shift(),d);while(w.length)b=w.shift(),i.relative[b]&&(b+=w.shift()),l=s(b,l)}else{!f&&w.length>1&&d.nodeType===9&&!v&&i.match.ID.test(w[0])&&!i.match.ID.test(w[w.length-1])&&(p=h.find(w.shift(),d,v),d=p.expr?h.filter(p.expr,p.set)[0]:p.set[0]);if(d){p=f?{expr:w.pop(),set:m(f)}:h.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),l=p.expr?h.filter(p.expr,p.set):p.set,w.length>0?n=m(l):u=!1;while(w.length)q=w.pop(),r=q,i.relative[q]?r=w.pop():q="",r==null&&(r=d),i.relative[q](n,r,v)}else n=w=[]}n||(n=l),n||h.error(q||b);if(c.call(n)==="[object Array]")if(!u)e.push.apply(e,n);else if(d&&d.nodeType===1)for(t=0;n[t]!=null;t++)n[t]&&(n[t]===!0||n[t].nodeType===1&&h.contains(d,n[t]))&&e.push(l[t]);else for(t=0;n[t]!=null;t++)n[t]&&n[t].nodeType===1&&e.push(l[t]);else m(n,e);return o&&(h(o,g,e,f),h.uniqueSort(e)),e};h.uniqueSort=function(a){if(o){d=e,a.sort(o);if(d)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},h.matches=function(a,b){return h(a,null,null,b)},h.matchesSelector=function(a,b){return h(b,null,null,[a]).length>0},h.find=function(a,b,c){var d;if(!a)return[];for(var e=0,g=i.order.length;e<g;e++){var h,j=i.order[e];if(h=i.leftMatch[j].exec(a)){var k=h[1];h.splice(1,1);if(k.substr(k.length-1)!=="\\"){h[1]=(h[1]||"").replace(f,""),d=i.find[j](h,b,c);if(d!=null){a=a.replace(i.match[j],"");break}}}}return d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]),{set:d,expr:a}},h.filter=function(a,b,c,d){var e,f,g=a,j=[],k=b,l=b&&b[0]&&h.isXML(b[0]);while(a&&b.length){for(var m in i.filter)if((e=i.leftMatch[m].exec(a))!=null&&e[2]){var n,o,p=i.filter[m],q=e[1];f=!1,e.splice(1,1);if(q.substr(q.length-1)==="\\")continue;k===j&&(j=[]);if(i.preFilter[m]){e=i.preFilter[m](e,k,c,j,d,l);if(!e)f=n=!0;else if(e===!0)continue}if(e)for(var r=0;(o=k[r])!=null;r++)if(o){n=p(o,e,r,k);var s=d^!!n;c&&n!=null?s?f=!0:k[r]=!1:s&&(j.push(o),f=!0)}if(n!==undefined){c||(k=j),a=a.replace(i.match[m],"");if(!f)return[];break}}if(a===g)if(f==null)h.error(a);else break;g=a}return k},h.error=function(a){throw"Syntax error, unrecognized expression: "+a};var i=h.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!g.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,i=a.length,j;f<i;f++)if(j=a[f]){while((j=j.previousSibling)&&j.nodeType!==1);a[f]=e||j&&j.nodeName.toLowerCase()===b?j||!1:j===b}e&&h.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!g.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var i=c.parentNode;a[e]=i.nodeName.toLowerCase()===b?i:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&h.filter(b,a,!0)}},"":function(a,c,d){var e,f=b++,h=r;typeof c=="string"&&!g.test(c)&&(c=c.toLowerCase(),e=c,h=q),h("parentNode",c,f,a,e,d)},"~":function(a,c,d){var e,f=b++,h=r;typeof c=="string"&&!g.test(c)&&(c=c.toLowerCase(),e=c,h=q),h("previousSibling",c,f,a,e,d)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,g){a=" "+a[1].replace(f,"")+" ";if(g)return a;for(var h=0,i;(i=b[h])!=null;h++)i&&(e^(i.className&&(" "+i.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(i):c&&(b[h]=!1));return!1},ID:function(a){return a[1].replace(f,"")},TAG:function(a,b){return a[1].replace(f,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||h.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var c=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=c[1]+(c[2]||1)-0,a[3]=c[3]-0}else a[2]&&h.error(a[0]);return a[0]=b++,a},ATTR:function(a,b,c,d,e,g){var h=a[1]=a[1].replace(f,"");return!g&&i.attrMap[h]&&(a[1]=i.attrMap[h]),a[4]=(a[4]||a[5]||"").replace(f,""),a[2]==="~="&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=h(b[3],null,null,c);else{var g=h.filter(b[3],c,d,!0^f);return d||e.push.apply(e,g),!1}else if(i.match.POS.test(b[0])||i.match.CHILD.test(b[0]))return!0;return b},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!h(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=i.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||h.getText([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var j=0,k=g.length;j<k;j++)if(g[j]===a)return!1;return!0}h.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case"only":case"first":while(d=d.previousSibling)if(d.nodeType===1)return!1;if(c==="first")return!0;d=a;case"last":while(d=d.nextSibling)if(d.nodeType===1)return!1;return!0;case"nth":var e=b[2],f=b[3];if(e===1&&f===0)return!0;var g=b[0],h=a.parentNode;if(h&&(h.sizcache!==g||!a.nodeIndex)){var i=0;for(d=h.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++i);h.sizcache=g}var j=a.nodeIndex-f;return e===0?j===0:j%e===0&&j/e>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=i.attrHandle[c]?i.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=i.setFilters[e];if(f)return f(a,c,b,d)}}},j=i.match.POS,k=function(a,b){return"\\"+(b-0+1)};for(var l in i.match)i.match[l]=new RegExp(i.match[l].source+/(?![^\[]*\])(?![^\(]*\))/.source),i.leftMatch[l]=new RegExp(/(^(?:.|\r|\n)*?)/.source+i.match[l].source.replace(/\\(\d+)/g,k));var m=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(n){m=function(a,b){var d=0,e=b||[];if(c.call(a)==="[object Array]")Array.prototype.push.apply(e,a);else if(typeof a.length=="number")for(var f=a.length;d<f;d++)e.push(a[d]);else for(;a[d];d++)e.push(a[d]);return e}}var o,p;document.documentElement.compareDocumentPosition?o=function(a,b){return a===b?(d=!0,0):!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(o=function(a,b){if(a===b)return d=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,e,f=[],g=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return p(a,b);if(!h)return-1;if(!i)return 1;while(j)f.unshift(j),j=j.parentNode;j=i;while(j)g.unshift(j),j=j.parentNode;c=f.length,e=g.length;for(var k=0;k<c&&k<e;k++)if(f[k]!==g[k])return p(f[k],g[k]);return k===c?p(a,g[k],-1):p(f[k],b,1)},p=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),h.getText=function(a){var b="",c;for(var d=0;a[d];d++)c=a[d],c.nodeType===3||c.nodeType===4?b+=c.nodeValue:c.nodeType!==8&&(b+=h.getText(c.childNodes));return b},function(){var a=document.createElement("div"),b="script"+(new Date).getTime(),c=document.documentElement;a.innerHTML="<a name='"+b+"'/>",c.insertBefore(a,c.firstChild),document.getElementById(b)&&(i.find.ID=function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d?d.id===a[1]||typeof d.getAttributeNode!="undefined"&&d.getAttributeNode("id").nodeValue===a[1]?[d]:undefined:[]}},i.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),c.removeChild(a),c=a=null}(),function(){var a=document.createElement("div");a.appendChild(document.createComment("")),a.getElementsByTagName("*").length>0&&(i.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(i.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),document.querySelectorAll&&function(){var a=h,b=document.createElement("div"),c="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)return;h=function(b,d,e,f){d=d||document;if(!f&&!h.isXML(d)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(g&&(d.nodeType===1||d.nodeType===9)){if(g[1])return m(d.getElementsByTagName(b),e);if(g[2]&&i.find.CLASS&&d.getElementsByClassName)return m(d.getElementsByClassName(g[2]),e)}if(d.nodeType===9){if(b==="body"&&d.body)return m([d.body],e);if(g&&g[3]){var j=d.getElementById(g[3]);if(!j||!j.parentNode)return m([],e);if(j.id===g[3])return m([j],e)}try{return m(d.querySelectorAll(b),e)}catch(k){}}else if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var l=d,n=d.getAttribute("id"),o=n||c,p=d.parentNode,q=/^\s*[+~]/.test(b);n?o=o.replace(/'/g,"\\$&"):d.setAttribute("id",o),q&&p&&(d=d.parentNode);try{if(!q||p)return m(d.querySelectorAll("[id='"+o+"'] "+b),e)}catch(r){}finally{n||l.removeAttribute("id")}}}return a(b,d,e,f)};for(var d in a)h[d]=a[d];b=null}(),function(){var a=document.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(document.createElement("div"),"div"),d=!1;try{b.call(document.documentElement,"[test!='']:sizzle")}catch(e){d=!0}h.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!h.isXML(a))try{if(d||!i.match.PSEUDO.test(e)&&!/!=/.test(e)){var f=b.call(a,e);if(f||!c||a.document&&a.document.nodeType!==11)return f}}catch(g){}return h(e,null,null,[a]).length>0}}}(),function(){var a=document.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!a.getElementsByClassName||a.getElementsByClassName("e").length===0)return;a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;i.order.splice(1,0,"CLASS"),i.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}(),document.documentElement.contains?h.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:document.documentElement.compareDocumentPosition?h.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:h.contains=function(){return!1},h.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var s=function(a,b){var c,d=[],e="",f=b.nodeType?[b]:b;while(c=i.match.PSEUDO.exec(a))e+=c[0],a=a.replace(i.match.PSEUDO,"");a=i.relative[a]?a+"*":a;for(var g=0,j=f.length;g<j;g++)h(a,f[g],d);return h.filter(e,d)},t=window.Sizzle;h.noConflict=function(){window.Sizzle=t},window.Sizzle=h}(),function(a){var b=QQWB,c=b.bigtable,d=window.Sizzle,e={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",innerhtml:"innerHTML",src:"src",maxlength:"maxLength",type:"type"},f;d.noConflict(),f={},QQWB.provide("dom.$",function(a,c){var d,e;return a&&a.nodeType==1?e=[a]:b.String.isString(a)&&(e=this.find(a,c)),d=b.Object.create(f),d.all=e,d}),QQWB.extend("dom",{ready:function(a){var d=c.get("document","ready"),e;return d?a&&a():(b.bind(c.get("nativeevent","documentready"),a),e=c.get("document","tryready"),e&&e()),b},find:function(a,b,c){return d(a,b,c)},createElement:function(a,b){var c=document.createElement(a);return this.setProperties(c,b),c},setProperties:function(a,b){var c=QQWB,d=c.Object;d.forEach(b,function(b,d){d=="style"?a.style.cssText=b:d=="class"?a.className=b:d=="for"?a.htmlFor=b:d in e?a[e[d]]=b:c.String.startsWith(d,"aria-")?a.setAttribute(d,b):c.String.startsWith(d,"data-")?a.setAttribute(d,b):a[d]=b})},getProperties:function(a,c,d){var f=c;return d=d||{},b.String.isString(f)&&(f=[f]),b.Array.forEach(f,function(c,f){c=="style"?d[c]=a.style.cssText:c=="class"?d[c]=a.className:c=="for"?d[c]=a.htmlFor:c in e?d[c]=a[e[c]]:b.String.startsWith(c,"aria-")?d[c]=a.getAttribute(c):b.String.startsWith(c,"data-")?d[c]=a.getAttribute(c):d[c]=a[c]}),b.String.isString(c)?d[c]:d}}),QQWB.documentReady=QQWB.dom.ready,QQWB.find=QQWB.dom.find,QQWB.browser.rendererMode.quirks&&QQWB.documentReady(function(){QQWB.extend("browser.viewport",QQWB.bigtable.get("browser","detectviewportsize")(),!0)})}(),function(){var a=QQWB,b=a.bigtable,c;c=function(){var a=QQWB,b=a.bigtable,c=a.log,d=b.get("document","ready"),e=b.get("boot","everythingready"),f=b.get("boot","tokenready"),g,h,i,j;if(d)return;i=document.getElementsByTagName("body")[0];if(!i)return;try{j=i.appendChild(document.createElement("span")),j.parentNode.removeChild(j)}catch(k){return}b.put("document","ready",!0),c.info("document is ready"),e&&e.unlock("document is ready"),g=f&&f.isOpen(),h=b.get("base","inited"),!g&&!h&&c.info("waiting init signal ..."),a.trigger(b.get("nativeevent","documentready"))},b.put("document","tryready",c),window.addEventListener&&document.addEventListener("DOMContentLoaded",function(){c()},!1),window.attachEvent&&(document.attachEvent("onreadystatechange",function(){/complete/.test(document.readyState)&&(document.detachEvent("onreadystatechange",arguments.callee),c())}),window===window.top&&function(){var a=QQWB,b=a.bigtable,d=b.get("document","ready");if(d)return;try{document.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}c()}()),a.browser.webkit&&function(){var a=QQWB,b=a.bigtable,d=b.get("document","ready");if(d)return;if(!/load|complete/.test(document.readyState)){setTimeout(arguments.callee,0);return}c()}()}(),function(){var a=QQWB,b=a.bigtable,c=a.dom,d=a.log,e=a.queryString,f=a.String,g=a.Array,h=[],i,j,j={dimension:function(b,c){return typeof b=="object"?a.extend(this.componentConfig,b,!0):a.extend(this.componentConfig,{width:b,height:c},!0),this},width:function(b){return a.extend(this.componentConfig,{width:b},!0),this},height:function(b){return a.extend(this.componentConfig,{height:b},!0),this},style:function(b){return a.extend(this.componentConfig,{style:b},!0),this},config:function(b){return a.extend(this.componentConfig,b,!0),this},renderInto:function(b){function h(a){var b,g,h;g=i(c.componentName);if(!g.hasOwnProperty("create"))throw e="\u521b\u5efa"+c.componentName+"\u7ec4\u4ef6\u5931\u8d25\uff0c\u672a\u5b9a\u4e49create\u65b9\u6cd5",d.error(e),new Error(e);h=g.create(c.componentConfig);if(typeof h!="undefined"&&h.nodeType==1)a.appendChild(h);else if(f.isString(h))a.innerHTML=h;else throw e="\u521b\u5efa"+c.componentName+"\u7ec4\u4ef6\u5931\u8d25\uff0c\u65e0\u6cd5\u5904\u7406\u7684create\u65b9\u6cd5\u8fd4\u56de\u7ed3\u679c",d.error(e),new Error(e)}var c=this,e,g=b,h;if(b&&b.nodeType==1)h(b);else if(f.isString(b))a.dom.ready(function(){b=a.dom.find(g);if(b.length>0)b=b[0],h(b);else throw e="\u52a0\u8f7d"+c.componentName+"\u7ec4\u4ef6\u5931\u8d25\uff0c\u672a\u627e\u5230\u8282\u70b9"+g,d.error(e),new Error(e)});else throw e="\u52a0\u8f7d"+c.componentName+"\u7ec4\u4ef6\u5931\u8d25\uff0c\u65e0\u6548\u7684\u8282\u70b9"+b,d.error(e),new Error(e)},render:function(){var a,b,e=this,f=i(e.componentName);c.ready(function(){var a=document.getElementById(f.idname);if(a&&a.nodeType==1)e.renderInto(a);else throw b=["\u672a\u627e\u5230",f.componentName,"\u8282\u70b9",f.idname].join(""),d.error(b),new Error(b)})}};i=function(a){var b;return g.each(h,function(c,d){if(d.name==a)return b=d,!1}),b},a.provide("component",function(a,b){var c=QQWB,d=c.String,e=c.Object,f=c.log,g,h,k;a=d.trim(a),g=i(a);if(!g)throw h="\u65e0\u6cd5\u4f7f\u7528\u7ec4\u4ef6"+a+"\uff0c\u8be5\u7ec4\u4ef6\u4e0d\u5b58\u5728",f.error(h),new Error(h);return k=c.Object.create(j),k.componentName=a,b?k.componentConfig=b:k.componentConfig={},c.extend(k,g.methods),k}),a.extend("component",{defineComponent:function(a){var b="\u5b9a\u4e49\u7ec4\u4ef6\u9519\u8bef\uff0c",c,e;if(!a.hasOwnProperty("name"))throw e=b+"\u5fc5\u987b\u4e3a\u7ec4\u4ef6\u6307\u5b9a\u540d\u79f0",d.error(e),new Error(e);if(!a.hasOwnProperty("create"))throw e=b+"\u5fc5\u987b\u5b9e\u73b0\u521b\u5efa\u7ec4\u4ef6\u903b\u8f91create\u65b9\u6cd5",d.error(e),new Error(e);if(!a.hasOwnProperty("idname"))throw e=b+"\u7f3a\u5c11idname",d.error(e),new Error(e);if(!a.hasOwnProperty("version"))throw e=b+"\u7f3a\u5c11version",d.error(e),new Error(e);c=i(a.name);if(c&&!c.allowRedefination)throw e=b+"\u7ec4\u4ef6"+c.name+"\u5df2\u5b58\u5728\uff0c\u5e76\u4e14\u4e0d\u5141\u8bb8\u88ab\u91cd\u65b0\u5b9a\u4e49",d.error(e),new Error(e);h.push(a)}}),a.component.defineComponent({name:"\u5fae\u8bc4\u8bba",version:"1.0",allowRedefination:!1,idname:"qqwb_comment__",attributes:"width height style appkey title colors",create:function(b){var f,g,h="http://comment.v.t.qq.com/index.html",i=location.href,j={};if(!b.appkey)throw f="\u521b\u5efa"+this.name+"\u7ec4\u4ef6\u5931\u8d25\uff0c\u7f3a\u5c11Appkey",d.error(f),new Error(f);return location
.hash&&(i=i.replace(location.hash,"")),a.extend(j,{src:[h,"#",e.encode({appkey:b.appkey,url:i,title:b.title,colorset:b.colors&&b.colors.join("_")})].join(""),width:b.width||"100%",height:b.height||"500",frameborder:0,scrolling:"no",allowtransparency:"true"}),g=c.createElement("iframe",j),g},methods:{appkey:function(b){return a.extend(this.componentConfig,{appkey:b},!0),this},colors:function(b){return f.isString(b)&&(b=g.fromArguments(arguments)),g.isArray(b)?a.extend(this.componentConfig,{colors:b},!0):d.error("component set colors error, expect an array"),this}}}),d.info("scanning components ..."),c.ready(function(){var b=0;g.forEach(h,function(c){var e=c.idname,f=(c.attributes||"").split(/\s+/),h,i,j={},k=document.getElementById(e);h=g.forEach(f,function(a,b){return"data-"+a});if(k){d.debug(["try render component [",c.name," ",c.version,"]"].join("")),i=a.dom.getProperties(k,h),a.Object.forEach(i,function(a,b){a&&(b=b.replace("data-",""),j[b]=a)}),d.debug(["read configuration ",QQWB.JSON.stringify(j)].join(""));try{a.component(c.name).config(j).render()}catch(l){d.error(["render component [",c.name,c.version,"] error exception: ",l].join(""))}b++}}),d.info("found "+b+" components")})}(),QQWB.browser.feature.localstorage?QQWB.extend("localStorage",{set:function(a,b,c){var d=QQWB,e,f;if(!a||b==null)return d.log.error(["[localstorage] save error, key or value is empty [",a,"] value [",b,"]"].join("")),!1;a="k"+a,e=d.time.secondsNow()+(c||7)*24*3600,f={value:b,expire:e};try{localStorage[a]=d.JSON.stringify(f)}catch(g){d.log.error("[localstorage] save error key ["+a+"] value ["+b+"]"+g);return}return localStorage[a]},get:function(a,b){var c=QQWB,d;if(!a){c.log.error("[localstorage] get error, key is empty");return}return a="k"+a,d=localStorage[a],d&&(d=c.JSON.parse(d))&&d.value&&c.time.secondsNow()<d.expire?d.value:b},del:function(a){var b=QQWB;return a?(a="k"+a,localStorage.removeItem(a),typeof localStorage[a]=="undefined"):(b.log.error("[localstorage] del error, key is empty"),!1)}}):QQWB.browser.feature.userdata?function(){var a=QQWB,b,c="QQWBLocalStorage";a.dom.ready(function(){var c=a.bigtable.get("localstorage","writecache"),d=a.bigtable.get("localstorage","deletecache");b=document.createElement("input"),b.type="hidden",b.style.display="none",b.addBehavior("#default#userData"),b.expires=(new Date(a.time.now()+31536e7)).toUTCString(),document.body.appendChild(b),c&&c.length>0&&a.Array.forEach(c,function(b){a.localStorage.set.apply(a.localStorage,b)}),d&&d.length>0&&a.Array.forEach(d,function(b){a.localStorage.del.apply(a.localStorage,b)})}),a.extend("localStorage",{set:function(a,d,e){var f=QQWB,g,h,i;if(!a||d==null)return f.log.error(["[localstorage] save error, key or value is empty [",a,"] value [",d,"]"].join("")),!1;if(!b)return g=f.bigtable.get("localstorage","writecache",[]),g.push(f.Array.fromArguments(arguments)),f.log.warning("userdata is not ready, save operation to write cache, key "+a),-1;a="k"+a,h=f.time.secondsNow()+(e||7)*24*3600,i={value:d,expire:h};try{b.load(c),b.setAttribute(a,JSON.stringify(i)),b.save(c)}catch(j){f.log.error("[localstorage] save error key ["+a+"] value ["+d+"]"+j);return}return b.getAttribute(a)},get:function(a,d){var e=QQWB,f;if(!a){e.log.error("[localstorage] get error, key is empty");return}return a="k"+a,b?(b.load(c),f=b.getAttribute(a),f&&(f=JSON.parse(f))&&f.value&&e.time.secondsNow()<f.expire?f.value:d):(e.log.error("[localStorage] can't get value for key "+a+",userData is currently unavaiable"),d)},del:function(a){var d=QQWB,e;return a?b?(a="k"+a,b.load(c),b.removeAttribute(a),b.save(c),typeof b.getAttribute(a)=="undefined"):(e=d.bigtable.get("localstorage","deletecache",[]),e.push(d.Array.fromArguments(arguments)),d.log.warning("userdata is not ready, save operation to delete cache, key "+a),-1):(d.log.error("[localstorage] del error, key is empty"),!1)}})}():(QQWB.log.error("localStorage is not supported and no workaround"),QQWB.extend("localStorage",{set:function(){return},get:function(){return},del:function(){return}})),QQWB.localStorage&&(QQWB.localStorage.save=QQWB.localStorage.set,QQWB.localStorage.remove=QQWB.localStorage.del),QQWB.extend("ping",{pingWith:function(a,b){function c(){var a=QQWB.cookie.get("uin",null),a=(a||"0").match(/\d+/)[0],b="";return{sIp:"",iQQ:a,sBiz:"openJS",sOp:"",iSta:"",iTy:1183,iFlow:b,iFrom:"",iPubFrom:"",sUrl:"",iUrlType:"",iPos:"",sText:"",iBak1:"",iBak2:"",sBak1:"",sBak2:QQWB.uid()}}a=QQWB.extend(c(),a,!0),QQWBPingTransport_18035d19=new Image(1,1),QQWBPingTransport_18035d19.src=[QQWB.bigtable.get("ping","urlbase"),"?",QQWB.queryString.encode(a,null,null,b)].join("")},pingInit:function(){function a(){var a=1e6,b=0;return QQWB.browser.msie?a+=100:QQWB.browser.opera?a+=200:QQWB.browser.webkit?a+=300:QQWB.browser.mozilla?a+=400:a+=500,QQWB.browser.feature.postmessage&&(b+=1),QQWB.browser.feature.flash&&(b+=2),QQWB.browser.feature.cookie&&(b+=4),a+=b,QQWB.bigtable.get("innerauth","enabled")&&(a+=1e4),a}function b(){var a=1e6;return QQWB.browser.platform.mobile?a+=100:a+=200,QQWB.browser.os.windows?a+=10:QQWB.browser.os.mac?a+=20:QQWB.browser.os.linux?a+=30:QQWB.browser.os.unix?a+=40:a+=50,a}return QQWB.ping.pingWith({sOp:"init",iFrom:QQWB.version.replace(/\./g,""),iPubFrom:b(),sUrl:[document.title,document.location.href].join(QQWB.bigtable.get("ping","paramsep")),sText:QQWB.bigtable.get("base","appkey"),iBak1:a()},QQWB.bigtable.get("ping","paramorder").concat("iFrom","iPubFrom","sUrl","iUrlType","iPos","sText","iBak1","iBak2","sBak1","sBak2"))}}),QQWB.extend("",{tokenReady:function(a){var b=QQWB,c=b.bigtable,d=c.get("boot","tokenready").isOpen();return d?a&&a():b.bind(c.get("nativeevent","tokenready"),a),b},everythingReady:function(a){var b=QQWB,c=b.bigtable,d=c.get("boot","everythingready").isOpen();return d?a&&a():b.bind(c.get("nativeevent","everythingready"),a),b}}),QQWB.ready=QQWB.everythingReady,QQWB.extend("door",{doors:0,door:function(a,b){var c=0;return this.doors++,{lock:function(b){return c++,a&&a.call(QQWB,b),this},unlock:function(a){return c--,c=Math.max(0,c),b&&b.call(QQWB,a),this},isOpen:function(){return c===0}}},count:function(){return this.doors}}),QQWB.bigtable.put("boot","solution",function(){var a=QQWB,b=a.bigtable,c=a.log,d=a.String,e=a.browser,f,g,h,i,j,k,l,m,n=15,o;f=b.put("boot","tokenready",QQWB.door.door(function(a){c.debug("tokenReady is locked"+(a?","+a:""))},function(d){c.debug("tokenReady is unlocked"+(d?","+d:"")),f.isOpen()&&(c.info("token is ready"),a.trigger(b.get("nativeevent","tokenready")))})),g=b.put("boot","everythingready",QQWB.door.door(function(a){c.debug("everythingReady is locked"+(a?","+a:""))},function(d){c.debug("everythingReady is unlocked"+(d?","+d:"")),g.isOpen()&&(c.info("everything is ready"),a.trigger(b.get("nativeevent","everythingready")),a.trigger(b.get("nativeevent","ready")))})),f.lock("waiting init"),g.lock("wait token ready"),b.get("document","ready")||g.lock("wait document ready"),a.bind(b.get("nativeevent","tokenready"),function(){g.unlock("token is ready")}),h=function(a){var b=QQWB,c=b.log,d=b.dom,e=b.bigtable,f=e.get("uri","html5proxy"),g=e.get("solution","deferred"),h;if(a){var i;i=function(a){f.indexOf(a.origin)!==0?c.warn("ignore a message from "+a.origin):a.data==="success"?(c.info("proxy frame was successfully loaded for html5 solution"),g.resolve(),window.addEventListener?window.removeEventListener("message",i,!1):window.attachEvent&&window.detachEvent("onmessage",i),i=null):c.warn("ignore wired message from "+a.origin)},window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent&&window.attachEvent("onmessage",i)}else b.once(e.get("innerauth","eventproxyready"),function(){c.info("proxy frame was successfully loaded for inner auth"),g.resolve()});d.ready(function(){var a,d="openjsframe_"+b.uid(5),i;c.info("loading proxy frame ..."),a=document.createElement("iframe"),a.id=d,a.src=f,a.style.display="none",i=function(){h&&clearTimeout(h)},a.attachEvent?a.attachEvent("onload",i):a.onload=i,h=setTimeout(function(){g.isResolved()||(g.reject(-6,"can't load proxy frame from path "+f+",request timeout"),c.critical("proxy frame error"))},n*1e3),setTimeout(function(){document.body.appendChild(a)},0),e.put("solution","frame",a)})},i=function(){var a=QQWB,b=a.log,c=a.bigtable,d=a.browser,e=a.dom,f=a.flash,g=c.get("solution","deferred"),h=c.get("uri","flashas3proxy"),i,j;e.ready(function(){var e,f,k="openjsflash_"+a.uid(5),l=c.get("solution","jscallbackname");b.info("init flash as3 solution ..."),window[l]=function(){i&&clearTimeout(i),f=window[k]||document.getElementById(k),f?(b.info("flash solution initlized successfully"),c.put("solution","flashmovie",f),g.resolve()):b.critical("proxy swf has unexpected error, os "+d.os.name+"; browser engine "+d.engine+"; version "+d.version);try{delete window[l]}catch(a){window[l]=j}},e=document.createElement("div"),e.style.width="0px",e.style.height="0px",e.style.position="absolute",e.style.top="-9999px",i=setTimeout(function(){if(!g.isResolved()){g.reject(-6,"can't load proxy swf from "+h+",request timeout");try{document.body.removeChild(e)}catch(a){}}},n*1e3),setTimeout(function(){document.body.appendChild(e),d.msie&&d.os.windows?e.innerHTML=['<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ','id="'+k+'" ','name="'+k+'">','<param name="movie" value="'+h+'"></param>','<param name="allowscriptaccess" value="always"></param>',"</object>"].join(""):e.innerHTML=['<object type= "application/x-shockwave-flash"','id="'+k+'" ','data="'+h+'">','<param name="allowscriptaccess" value="always"></param>',"</object>"].join("")},0)})},j=function(){h(!0),b.put("solution","name","html5")},k=function(){h(!1),b.put("solution","name","innerauth")},l=function(){c.info("flash player version "+e.feature.flash.version),e.feature.flash.externalinterface||c.warn("flash player too old, openjs may not work properly"),i(),b.put("solution","name","as3")},m=function(a){var c=b.get("solution","deferred");c.reject(-6,a)};if(b.get("innerauth","enabled")){k();return}if(QQWB.envs.crossdomainmethod=="auto")c.debug("detect crossdomain method"),e.feature.postmessage?j():e.feature.flash?l():(c.critical("no solution available, switch to modern browser or install latest flash player, then refresh this page"),m("no solution available, need a modern browser or install lastest flash player"));else{c.debug("load crossdomain method "+QQWB.envs.crossdomainmethod),o=d.trim(QQWB.envs.crossdomainmethod.toLowerCase());switch(o){case"html5":case"postmessage":e.feature.postmessage?j():(c.critical("can not setup crossdomain method "+QQWB.envs.crossdomainmethod+", browser not support"),m("postmessage solution can not be setted up"));break;case"flash":case"as3":e.feature.flash?l():(c.critical("can not setup crossdomain method "+QQWB.envs.crossdomainmethod+", browser not support"),m("flash as3 solution can not be setted up"))}}}),QQWB.envs.autoboot&&(QQWB.bigtable.put("boot","booting",!0),QQWB.bigtable.get("boot","solution")()),function(){var a=QQWB.bigtable.get("openjs","asynccallbackfunctionname");typeof window[a]=="function"&&window[a](QQWB)}()
